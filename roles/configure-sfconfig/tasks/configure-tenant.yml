- name: Configure tenant
  block:
    - name: Add tenant configuration in sfconfig
      blockinfile:
        path: /etc/software-factory/sfconfig.yaml
        insertafter: '^tenant-deployment:$'
        marker: "# {mark} ANSIBLE MANAGED BLOCK tenant"
        block: |2
            name: tenant
            master-sf: https://sftests.com

    - name: Remove default value for static_hostnames in sfconfig.yaml
      lineinfile:
        path: /etc/software-factory/sfconfig.yaml
        regexp: '^  static_hostnames:.*'
        line: '  static_hostnames:'

    - name: Add static master host
      blockinfile:
        path: /etc/software-factory/sfconfig.yaml
        insertafter: '^  static_hostnames:$'
        marker: "# {mark} ANSIBLE MANAGED BLOCK static hostname"
        block: |2
            - "{{ master_ip }} sftests.com"
